#ifndef __CUML__
#define __CUML__

#include "cudf"

RUN apt-get update && \\
    apt-get install -y --no-install-recommends \\
        libpthread-stubs0-dev \\
        zlib1g-dev && \\
    rm -rf /var/lib/apt/lists && \\
    mkdir /var/lib/apt/lists

RUN conda install \\
        cmake=3.13 \\
        Cython && \\
    conda clean -ya

RUN git clone --recursive "https://github.com/rapidsai/cuml" /opt/cuml && \\
    cd /opt/cuml/cuML && \\
    mkdir build && \\
    cd build && \\
    cmake .. && \\
    make -j && \\
    make install && \\
    cd ../../python && \\
    python setup.py build_ext --inplace && \\
    python setup.py install

RUN conda install -c anaconda pytest && \\
    conda clean -ya

RUN conda install -c pytorch faiss-gpu && \\
    conda clean -ya

#endif // __CUML__
